<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Neuron OS</title>
<link rel="stylesheet" href="style.css">
</head>
<body class="light">

<div id="auth-screen">
  <h2>Neuron OS</h2>
  <input type="email" id="email" placeholder="Email">
  <input type="password" id="password" placeholder="–ü–∞—Ä–æ–ª—å">
  <button id="login-btn">–í–æ–π—Ç–∏</button>
  <button id="register-btn">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
</div>

<div id="desktop" style="display:none;">
  <div id="dock">
    <div class="dock-icon" data-app="ai">üß†</div>
    <div class="dock-icon" data-app="notes">üìù</div>
    <div class="dock-icon" data-app="converter">üîÑ</div>
    <div class="dock-icon" data-app="budget">üí∞</div>
    <div class="dock-icon" data-app="tools">üß∞</div>
    <div class="dock-icon" data-app="games">üéÆ</div>
    <div class="dock-icon" data-app="browser">üåê</div>
    <div class="dock-icon" data-app="settings">‚öôÔ∏è</div>
  </div>
</div>

<!-- Windows -->
<div class="window" id="ai">
  <div class="window-header">
    <button class="close"></button>
    <button class="minimize"></button>
    <button class="maximize"></button>
  </div>
  <div class="window-content">
    <h2>Neuron AI</h2>
    <div id="ai-output" style="height:300px; overflow:auto;"></div>
    <input id="ai-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É..." style="width:100%; padding:5px;">
  </div>
</div>

<div class="window" id="notes">
  <div class="window-header">
    <button class="close"></button>
    <button class="minimize"></button>
    <button class="maximize"></button>
  </div>
  <div class="window-content">
    <h2>Neuron Notes</h2>
    <textarea id="notes-area" style="width:100%; height:300px;"></textarea>
  </div>
</div>

<div class="window" id="converter">
  <div class="window-header">
    <button class="close"></button>
    <button class="minimize"></button>
    <button class="maximize"></button>
  </div>
  <div class="window-content">
    <h2>Neuron Converter</h2>
    <input type="number" id="conv-input" placeholder="–í–≤–µ–¥–∏—Ç–µ —á–∏—Å–ª–æ">
    <select id="conv-type">
      <option value="usdToEur">USD ‚Üí EUR</option>
      <option value="eurToUsd">EUR ‚Üí USD</option>
    </select>
    <button id="conv-btn">–ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
    <div id="conv-result"></div>
  </div>
</div>

<div class="window" id="settings">
  <div class="window-header">
    <button class="close"></button>
    <button class="minimize"></button>
    <button class="maximize"></button>
  </div>
  <div class="window-content">
    <h2>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h2>
    <label>–¢–µ–º–∞:
      <select id="theme-select">
        <option value="light">–°–≤–µ—Ç–ª–∞—è</option>
        <option value="dark">–¢—ë–º–Ω–∞—è</option>
      </select>
    </label>
    <label>–ó–∞–≥—Ä—É–∑–∏—Ç—å –æ–±–æ–∏:
      <input type="file" id="wallpaper-upload" accept="image/*">
    </label>
    <div class="wallpaper-grid">
      <img src="https://picsum.photos/id/1015/200/120" class="wallpaper-thumb">
      <img src="https://picsum.photos/id/1020/200/120" class="wallpaper-thumb">
      <img src="https://picsum.photos/id/1024/200/120" class="wallpaper-thumb">
    </div>
    <button class="apply" id="apply-settings">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
  </div>
</div>

<script type="module" src="script.js"></script>

<!-- Firebase -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.5.0/firebase-app.js";
import { getFirestore, doc, getDoc, setDoc } from "https://www.gstatic.com/firebasejs/12.5.0/firebase-firestore.js";
import { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/12.5.0/firebase-auth.js";

const firebaseConfig = {
  apiKey: "AIzaSyDOaDVzzPjyYm4HWMND2XYWjLy_h4wty5s",
  authDomain: "neuron-ecosystem-2025.firebaseapp.com",
  projectId: "neuron-ecosystem-2025",
  storageBucket: "neuron-ecosystem-2025.firebasestorage.app",
  messagingSenderId: "589834476565",
  appId: "1:589834476565:web:622fe04057d33339dd421c",
  measurementId: "G-Z934BZPLG3"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);
const auth = getAuth(app);

// –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
const loginBtn=document.getElementById('login-btn');
const registerBtn=document.getElementById('register-btn');
const emailInput=document.getElementById('email');
const passInput=document.getElementById('password');
const authScreen=document.getElementById('auth-screen');
const desktop=document.getElementById('desktop');

loginBtn.addEventListener('click',()=>{
  signInWithEmailAndPassword(auth,emailInput.value,passInput.value)
  .then(()=>console.log('–í—Ö–æ–¥ —É—Å–ø–µ—à–µ–Ω'))
  .catch(e=>alert(e.message));
});

registerBtn.addEventListener('click',()=>{
  createUserWithEmailAndPassword(auth,emailInput.value,passInput.value)
  .then(()=>console.log('–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞'))
  .catch(e=>alert(e.message));
});

onAuthStateChanged(auth,user=>{
  if(user){
    authScreen.style.display='none';
    desktop.style.display='block';
    loadUserData(user.uid);
  }else{
    authScreen.style.display='flex';
    desktop.style.display='none';
  }
});

async function loadUserData(uid){
  const docRef = doc(db,"users",uid);
  const docSnap = await getDoc(docRef);
  if(docSnap.exists()){
    const data=docSnap.data();
    if(data.notes) document.getElementById('notes-area').value=data.notes;
    if(data.theme) document.body.className=data.theme;
    if(data.wallpaper) document.getElementById('desktop').style.backgroundImage=`url(${data.wallpaper})`;
  }
}
async function saveUserData(uid){
  const docRef = doc(db,"users",uid);
  await setDoc(docRef,{
    notes: document.getElementById('notes-area').value,
    theme: document.body.className,
    wallpaper: document.getElementById('desktop').style.backgroundImage.replace(/url\(|\)|"/g,'')
  }, {merge:true});
}

</script>
</body>
</html>
