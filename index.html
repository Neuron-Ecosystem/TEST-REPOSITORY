<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Neuron OS</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üß†</text></svg>">
    <style>
        /* –û—Å–Ω–æ–≤–Ω—ã–µ —Å—Ç–∏–ª–∏ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
        }

        body {
            overflow: hidden;
            background: #000;
            color: #fff;
            height: 100vh;
            width: 100vw;
        }

        /* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            animation: fadeIn 0.5s ease;
        }

        .login-window {
            background: rgba(30, 30, 40, 0.9);
            border-radius: 20px;
            padding: 40px;
            width: 400px;
            max-width: 90vw;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            animation: scaleIn 0.5s ease;
        }

        .login-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .login-header h2 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4, #45b7d1);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .login-header p {
            color: #ccc;
            font-size: 1rem;
        }

        .input-group {
            margin-bottom: 20px;
        }

        .input-group label {
            display: block;
            margin-bottom: 8px;
            color: #ccc;
            font-size: 0.9rem;
        }

        .input-group input {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .input-group input:focus {
            outline: none;
            border-color: #4ecdc4;
            box-shadow: 0 0 0 2px rgba(78, 205, 196, 0.2);
        }

        .login-button {
            width: 100%;
            padding: 14px;
            background: linear-gradient(45deg, #4ecdc4, #45b7d1);
            border: none;
            border-radius: 10px;
            color: white;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 15px;
        }

        .login-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(78, 205, 196, 0.3);
        }

        .google-login-button {
            width: 100%;
            padding: 14px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            color: white;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 20px;
        }

        .google-login-button:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .register-link {
            text-align: center;
            color: #ccc;
        }

        .register-link a {
            color: #4ecdc4;
            text-decoration: none;
        }

        .register-link a:hover {
            text-decoration: underline;
        }

        .demo-button {
            position: absolute;
            top: 20px;
            right: 20px;
            padding: 12px 20px;
            background: linear-gradient(45deg, #4ecdc4, #45b7d1);
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            box-shadow: 0 4px 15px rgba(78, 205, 196, 0.3);
            z-index: 1001;
        }

        /* –†–∞–±–æ—á–∏–π —Å—Ç–æ–ª */
        .desktop {
            position: relative;
            width: 100%;
            height: 100vh;
            display: none;
        }

        .wallpaper {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #0c0c0c 0%, #1a1a2e 50%, #16213e 100%);
            z-index: -1;
        }

        /* –ò–∫–æ–Ω–∫–∏ —Ä–∞–±–æ—á–µ–≥–æ —Å—Ç–æ–ª–∞ */
        .desktop-icons {
            position: absolute;
            top: 20px;
            left: 20px;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .desktop-icon {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 80px;
            padding: 10px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            user-select: none;
        }

        .desktop-icon:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: scale(1.05);
        }

        .desktop-icon .icon {
            font-size: 2rem;
            margin-bottom: 5px;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
        }

        .desktop-icon span {
            font-size: 0.8rem;
            text-align: center;
            color: white;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
        }

        /* –û–∫–Ω–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π */
        .window {
            position: absolute;
            top: 100px;
            left: 100px;
            width: 800px;
            height: 600px;
            max-width: 90vw;
            max-height: 80vh;
            background: rgba(30, 30, 40, 0.9);
            border-radius: 15px;
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            overflow: hidden;
            animation: windowOpen 0.3s ease;
            z-index: 10;
        }

        .window.minimized {
            display: none;
        }

        .window.maximized {
            width: 100% !important;
            height: calc(100% - 70px) !important;
            top: 0 !important;
            left: 0 !important;
            transform: none !important;
            border-radius: 0;
        }

        .window-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            background: rgba(0, 0, 0, 0.3);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            cursor: move;
            user-select: none;
        }

        .window-title {
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 600;
        }

        .window-controls {
            display: flex;
            gap: 10px;
        }

        .window-control {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .window-control.close {
            background: #ff5f57;
        }

        .window-control.minimize {
            background: #ffbd2e;
        }

        .window-control.maximize {
            background: #28ca42;
        }

        .window-control:hover {
            transform: scale(1.1);
        }

        .window-content {
            height: calc(100% - 50px);
            overflow: auto;
        }

        .window-content iframe {
            width: 100%;
            height: 100%;
            border: none;
            background: white;
        }

        /* –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–µ –º–µ–Ω—é */
        .context-menu {
            position: fixed;
            background: rgba(40, 40, 50, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 8px 0;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            z-index: 100;
            display: none;
            min-width: 200px;
        }

        .context-item {
            padding: 10px 20px;
            cursor: pointer;
            transition: background 0.2s ease;
            font-size: 0.9rem;
        }

        .context-item:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        /* –ü–∞–Ω–µ–ª—å –∑–∞–¥–∞—á (Dock) */
        .dock {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(40, 40, 50, 0.7);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 10px 20px;
            display: flex;
            align-items: center;
            gap: 20px;
            z-index: 100;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .dock-items {
            display: flex;
            gap: 5px;
        }

        .dock-item {
            position: relative;
            padding: 8px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .dock-item:hover {
            transform: translateY(-5px) scale(1.1);
        }

        .dock-item.active .dock-icon {
            filter: brightness(1.2) drop-shadow(0 0 10px rgba(78, 205, 196, 0.5));
        }

        .dock-icon {
            font-size: 1.8rem;
            transition: all 0.3s ease;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
        }

        .active-indicator {
            position: absolute;
            bottom: -2px;
            left: 50%;
            transform: translateX(-50%);
            width: 4px;
            height: 4px;
            background: white;
            border-radius: 50%;
        }

        .system-info {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-left: 20px;
        }

        .clock {
            font-size: 0.9rem;
            font-weight: 600;
            color: white;
        }

        /* –ú–µ–Ω—é "–ü—É—Å–∫" */
        .start-menu {
            position: fixed;
            bottom: 80px;
            left: 50%;
            transform: translateX(-50%);
            width: 500px;
            max-width: 90vw;
            height: 500px;
            max-height: 60vh;
            background: rgba(40, 40, 50, 0.9);
            backdrop-filter: blur(30px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
            z-index: 90;
            display: none;
            overflow: hidden;
        }

        .start-header {
            margin-bottom: 20px;
        }

        .start-header h3 {
            margin-bottom: 15px;
            color: white;
        }

        .search-box input {
            width: 100%;
            padding: 10px 15px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 0.9rem;
        }

        .app-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
            gap: 15px;
            overflow-y: auto;
            max-height: calc(100% - 80px);
        }

        .app-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 10px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .app-item:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: scale(1.05);
        }

        .app-icon {
            font-size: 1.8rem;
            margin-bottom: 5px;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
        }

        .app-item span {
            font-size: 0.7rem;
            text-align: center;
            color: white;
        }

        /* –ê–Ω–∏–º–∞—Ü–∏–∏ */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes scaleIn {
            from { 
                opacity: 0;
                transform: scale(0.8);
            }
            to { 
                opacity: 1;
                transform: scale(1);
            }
        }

        @keyframes windowOpen {
            from {
                opacity: 0;
                transform: scale(0.8);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 768px) {
            .desktop-icons {
                top: 10px;
                left: 10px;
                gap: 15px;
            }
            
            .desktop-icon {
                width: 60px;
            }
            
            .desktop-icon .icon {
                font-size: 1.5rem;
            }
            
            .desktop-icon span {
                font-size: 0.7rem;
            }
            
            .dock {
                bottom: 10px;
                padding: 8px 15px;
            }
            
            .dock-icon {
                font-size: 1.5rem;
            }
            
            .window {
                width: 95vw;
                height: 70vh;
            }
        }
    </style>
</head>
<body>
    <!-- –û–∫–Ω–æ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ -->
    <div id="login-modal" class="modal">
        <button class="demo-button" onclick="activateDemoMode()">–î–µ–º–æ-—Ä–µ–∂–∏–º</button>
        <div class="login-window">
            <div class="login-header">
                <h2>Neuron OS</h2>
                <p>–í–æ–π–¥–∏—Ç–µ –≤ —Å–≤–æ—é —ç–∫–æ—Å–∏—Å—Ç–µ–º—É</p>
            </div>
            <div class="login-form">
                <div class="input-group">
                    <label for="email">–≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞—è –ø–æ—á—Ç–∞</label>
                    <input type="email" id="email" placeholder="your@email.com" value="demo@neuron.ru">
                </div>
                <div class="input-group">
                    <label for="password">–ü–∞—Ä–æ–ª—å</label>
                    <input type="password" id="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" value="demo123">
                </div>
                <button id="login-btn" class="login-button" onclick="handleLogin()">–í–æ–π—Ç–∏</button>
                <button id="google-login" class="google-login-button" onclick="handleGoogleLogin()">
                    <span>–í–æ–π—Ç–∏ —Å –ø–æ–º–æ—â—å—é Google</span>
                </button>
                <p class="register-link">–ù–µ—Ç –∞–∫–∫–∞—É–Ω—Ç–∞? <a href="#" onclick="handleRegister()">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</a></p>
            </div>
        </div>
    </div>

    <!-- –†–∞–±–æ—á–∏–π —Å—Ç–æ–ª -->
    <div id="desktop" class="desktop">
        <!-- –û–±–æ–∏ -->
        <div class="wallpaper"></div>
        
        <!-- –ò–∫–æ–Ω–∫–∏ –Ω–∞ —Ä–∞–±–æ—á–µ–º —Å—Ç–æ–ª–µ -->
        <div class="desktop-icons">
            <div class="desktop-icon" data-app="ai" onclick="openApp('ai')">
                <div class="icon">üß†</div>
                <span>Neuron AI</span>
            </div>
            <div class="desktop-icon" data-app="notes" onclick="openApp('notes')">
                <div class="icon">üìù</div>
                <span>Neuron Notes</span>
            </div>
            <div class="desktop-icon" data-app="converter" onclick="openApp('converter')">
                <div class="icon">üîÑ</div>
                <span>Neuron Converter</span>
            </div>
            <div class="desktop-icon" data-app="budget" onclick="openApp('budget')">
                <div class="icon">üí∞</div>
                <span>Neuron Budget</span>
            </div>
            <div class="desktop-icon" data-app="tools" onclick="openApp('tools')">
                <div class="icon">üß∞</div>
                <span>Neuron Tools</span>
            </div>
            <div class="desktop-icon" data-app="games" onclick="openApp('games')">
                <div class="icon">üéÆ</div>
                <span>Game Hub</span>
            </div>
            <div class="desktop-icon" data-app="browser" onclick="openApp('browser')">
                <div class="icon">üåê</div>
                <span>–ò–Ω—Ç–µ—Ä–Ω–µ—Ç</span>
            </div>
            <div class="desktop-icon" data-app="settings" onclick="openApp('settings')">
                <div class="icon">‚öôÔ∏è</div>
                <span>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</span>
            </div>
        </div>

        <!-- –û–∫–Ω–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π -->
        <div id="windows-container"></div>

        <!-- –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–µ –º–µ–Ω—é -->
        <div id="context-menu" class="context-menu">
            <div class="context-item" data-action="pin" onclick="handleContextMenuAction('pin')">–ó–∞–∫—Ä–µ–ø–∏—Ç—å –Ω–∞ –ø–∞–Ω–µ–ª–∏ –∑–∞–¥–∞—á</div>
            <div class="context-item" data-action="open-tab" onclick="handleContextMenuAction('open-tab')">–û—Ç–∫—Ä—ã—Ç—å –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–π –≤–∫–ª–∞–¥–∫–µ</div>
            <div class="context-item" data-action="ask-ai" onclick="handleContextMenuAction('ask-ai')">–°–ø—Ä–æ—Å–∏—Ç—å —É –ò–ò</div>
        </div>
    </div>

    <!-- –ü–∞–Ω–µ–ª—å –∑–∞–¥–∞—á (Dock) -->
    <div class="dock">
        <div class="dock-items">
            <!-- –ò–∫–æ–Ω–∫–∞ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ –≤—Å–µ–≥–¥–∞ —Å–ª–µ–≤–∞ -->
            <div class="dock-item active" data-app="browser" onclick="openApp('browser')">
                <div class="dock-icon">üåê</div>
                <div class="active-indicator"></div>
            </div>
            
            <!-- –û—Å—Ç–∞–ª—å–Ω—ã–µ –∏–∫–æ–Ω–∫–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
        </div>
        
        <!-- –ß–∞—Å—ã –∏ —Å–∏—Å—Ç–µ–º–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
        <div class="system-info">
            <div id="clock" class="clock">00:00</div>
        </div>
    </div>

    <!-- –ú–µ–Ω—é "–ü—É—Å–∫" -->
    <div id="start-menu" class="start-menu">
        <div class="start-header">
            <h3>–ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è</h3>
            <div class="search-box">
                <input type="text" id="app-search" placeholder="–ü–æ–∏—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π..." oninput="filterApps()">
            </div>
        </div>
        <div class="app-grid">
            <div class="app-item" data-app="ai" onclick="openApp('ai')">
                <div class="app-icon">üß†</div>
                <span>Neuron AI</span>
            </div>
            <div class="app-item" data-app="notes" onclick="openApp('notes')">
                <div class="app-icon">üìù</div>
                <span>Neuron Notes</span>
            </div>
            <div class="app-item" data-app="converter" onclick="openApp('converter')">
                <div class="app-icon">üîÑ</div>
                <span>Neuron Converter</span>
            </div>
            <div class="app-item" data-app="study" onclick="openApp('study')">
                <div class="app-icon">üìö</div>
                <span>Neuron Study</span>
            </div>
            <div class="app-item" data-app="password" onclick="openApp('password')">
                <div class="app-icon">üîê</div>
                <span>Password Generator</span>
            </div>
            <div class="app-item" data-app="budget" onclick="openApp('budget')">
                <div class="app-icon">üí∞</div>
                <span>Neuron Budget</span>
            </div>
            <div class="app-item" data-app="games" onclick="openApp('games')">
                <div class="app-icon">üéÆ</div>
                <span>Game Hub</span>
            </div>
            <div class="app-item" data-app="tools" onclick="openApp('tools')">
                <div class="app-icon">üß∞</div>
                <span>Neuron Tools</span>
            </div>
            <div class="app-item" data-app="synapse" onclick="openApp('synapse')">
                <div class="app-icon">üåê</div>
                <span>Synapse</span>
            </div>
            <div class="app-item" data-app="settings" onclick="openApp('settings')">
                <div class="app-icon">‚öôÔ∏è</div>
                <span>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</span>
            </div>
        </div>
    </div>

    <script>
        // –õ–æ–∫–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (–±–µ–∑ Firebase)
        const state = {
            currentUser: null,
            userData: {},
            openWindows: {},
            dockApps: ['browser', 'settings'],
            activeApp: null,
            users: JSON.parse(localStorage.getItem('neuron_users')) || {},
            isDemoMode: false
        };

        // –ö–∞—Ä—Ç–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
        const apps = {
            'ai': { name: 'Neuron AI', icon: 'üß†', url: null, builtin: true },
            'notes': { name: 'Neuron Notes', icon: 'üìù', url: 'https://neuron-p2p.ru/notes.html' },
            'converter': { name: 'Neuron Converter', icon: 'üîÑ', url: 'https://neuron-ecosystem.github.io/Unit-Converter/' },
            'study': { name: 'Neuron Study', icon: 'üìö', url: 'https://neuron-ecosystem.github.io/Neuron-Study/' },
            'password': { name: 'Password Generator', icon: 'üîê', url: 'https://neuron-ecosystem.github.io/Password-Generator/' },
            'budget': { name: 'Neuron Budget', icon: 'üí∞', url: 'https://neuron-ecosystem.github.io/Neuron-Budget/' },
            'games': { name: 'Game Hub', icon: 'üéÆ', url: 'https://neuron-ecosystem.github.io/Game-Hub/' },
            'tools': { name: 'Neuron Tools', icon: 'üß∞', url: 'https://neuron-ecosystem.github.io/Neuron-Tools/' },
            'synapse': { name: 'Synapse', icon: 'üåê', url: 'https://neuron-ecosystem.github.io/Synapse/' },
            'browser': { name: '–ò–Ω—Ç–µ—Ä–Ω–µ—Ç', icon: 'üåê', url: 'https://neuron-p2p.ru' },
            'settings': { name: '–ù–∞—Å—Ç—Ä–æ–π–∫–∏', icon: '‚öôÔ∏è', url: null, builtin: true }
        };

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        document.addEventListener('DOMContentLoaded', function() {
            checkAuthStatus();
            initializeClock();
            initializeEventListeners();
        });

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
        function checkAuthStatus() {
            const savedUser = localStorage.getItem('neuron_current_user');
            if (savedUser) {
                state.currentUser = JSON.parse(savedUser);
                showDesktop();
                loadUserData();
            } else {
                showLoginModal();
            }
        }

        // –ê–∫—Ç–∏–≤–∞—Ü–∏—è –¥–µ–º–æ-—Ä–µ–∂–∏–º–∞
        function activateDemoMode() {
            state.isDemoMode = true;
            state.currentUser = { email: 'demo@neuron.ru', uid: 'demo-user' };
            localStorage.setItem('neuron_current_user', JSON.stringify(state.currentUser));
            showDesktop();
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
        function showLoginModal() {
            document.getElementById('login-modal').style.display = 'flex';
            document.getElementById('desktop').style.display = 'none';
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å —Ä–∞–±–æ—á–∏–π —Å—Ç–æ–ª
        function showDesktop() {
            document.getElementById('login-modal').style.display = 'none';
            document.getElementById('desktop').style.display = 'block';
            initializeDock();
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —á–∞—Å–æ–≤
        function initializeClock() {
            function updateClock() {
                const now = new Date();
                const timeString = now.toLocaleTimeString('ru-RU', { 
                    hour: '2-digit', 
                    minute: '2-digit' 
                });
                document.getElementById('clock').textContent = timeString;
            }
            
            updateClock();
            setInterval(updateClock, 1000);
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π
        function initializeEventListeners() {
            // –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–µ –º–µ–Ω—é –¥–ª—è –∏–∫–æ–Ω–æ–∫ —Ä–∞–±–æ—á–µ–≥–æ —Å—Ç–æ–ª–∞
            document.querySelectorAll('.desktop-icon').forEach(icon => {
                icon.addEventListener('contextmenu', (e) => {
                    e.preventDefault();
                    showContextMenu(e, e.currentTarget.dataset.app);
                });
            });

            // –ó–∞–∫—Ä—ã—Ç–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–≥–æ –º–µ–Ω—é
            document.addEventListener('click', hideContextMenu);
        }

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Ö–æ–¥–∞
        function handleLogin() {
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            
            if (!email || !password) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è');
                return;
            }
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
            const loginBtn = document.getElementById('login-btn');
            const originalText = loginBtn.textContent;
            loginBtn.textContent = '–í—Ö–æ–¥...';
            loginBtn.disabled = true;
            
            // –õ–æ–∫–∞–ª—å–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
            setTimeout(() => {
                const user = state.users[email];
                if (user && user.password === password) {
                    state.currentUser = { email, uid: email };
                    localStorage.setItem('neuron_current_user', JSON.stringify(state.currentUser));
                    showDesktop();
                } else {
                    alert('–ù–µ–≤–µ—Ä–Ω—ã–π email –∏–ª–∏ –ø–∞—Ä–æ–ª—å');
                }
                
                loginBtn.textContent = originalText;
                loginBtn.disabled = false;
            }, 1000);
        }

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Ö–æ–¥–∞ —á–µ—Ä–µ–∑ Google
        function handleGoogleLogin() {
            const googleBtn = document.getElementById('google-login');
            const originalText = googleBtn.innerHTML;
            googleBtn.innerHTML = '<span>–í—Ö–æ–¥ —á–µ—Ä–µ–∑ Google...</span>';
            googleBtn.disabled = true;

            setTimeout(() => {
                alert('Google –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ —Å–ª–µ–¥—É—é—â–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–µ–º–æ-—Ä–µ–∂–∏–º.');
                googleBtn.innerHTML = originalText;
                googleBtn.disabled = false;
            }, 1000);
        }

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
        function handleRegister() {
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            
            if (!email || !password) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏');
                return;
            }
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
            const loginBtn = document.getElementById('login-btn');
            const originalText = loginBtn.textContent;
            loginBtn.textContent = '–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è...';
            loginBtn.disabled = true;
            
            // –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
            setTimeout(() => {
                if (state.users[email]) {
                    alert('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º email —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç');
                } else {
                    state.users[email] = { email, password, createdAt: new Date() };
                    state.currentUser = { email, uid: email };
                    
                    localStorage.setItem('neuron_users', JSON.stringify(state.users));
                    localStorage.setItem('neuron_current_user', JSON.stringify(state.currentUser));
                    
                    showDesktop();
                    alert('–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ Neuron OS!');
                }
                
                loginBtn.textContent = originalText;
                loginBtn.disabled = false;
            }, 1000);
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Dock
        function initializeDock() {
            const dockItems = document.querySelector('.dock-items');
            
            // –û—á–∏—â–∞–µ–º –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –∫—Ä–æ–º–µ –±—Ä–∞—É–∑–µ—Ä–∞
            const browserItem = dockItems.querySelector('.dock-item[data-app="browser"]');
            dockItems.innerHTML = '';
            dockItems.appendChild(browserItem);
            
            // –î–æ–±–∞–≤–ª—è–µ–º –∑–∞–∫—Ä–µ–ø–ª–µ–Ω–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
            state.dockApps.forEach(appId => {
                if (appId !== 'browser') {
                    addAppToDock(appId);
                }
            });
        }

        // –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ Dock
        function addAppToDock(appId) {
            const app = apps[appId];
            if (!app) return;
            
            const dockItems = document.querySelector('.dock-items');
            const dockItem = document.createElement('div');
            dockItem.className = 'dock-item';
            dockItem.dataset.app = appId;
            dockItem.onclick = () => toggleAppWindow(appId);
            
            dockItem.innerHTML = `
                <div class="dock-icon">${app.icon}</div>
                <div class="active-indicator" style="display: none;"></div>
            `;
            
            dockItems.appendChild(dockItem);
        }

        // –û—Ç–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
        function openApp(appId) {
            const app = apps[appId];
            if (!app) return;
            
            // –ï—Å–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —É–∂–µ –æ—Ç–∫—Ä—ã—Ç–æ, –∞–∫—Ç–∏–≤–∏—Ä—É–µ–º –µ–≥–æ
            if (state.openWindows[appId]) {
                bringWindowToFront(appId);
                return;
            }
            
            // –°–æ–∑–¥–∞–µ–º –æ–∫–Ω–æ
            createAppWindow(appId);
            
            // –î–æ–±–∞–≤–ª—è–µ–º –≤ Dock –µ—Å–ª–∏ –µ—â–µ –Ω–µ—Ç
            if (!state.dockApps.includes(appId)) {
                state.dockApps.push(appId);
                addAppToDock(appId);
                saveUserData();
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä
            updateActiveApp(appId);
        }

        // –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –æ–∫–Ω–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–æ—Ç–∫—Ä—ã—Ç—å/—Å–≤–µ—Ä–Ω—É—Ç—å)
        function toggleAppWindow(appId) {
            if (state.openWindows[appId]) {
                if (state.openWindows[appId].classList.contains('minimized')) {
                    // –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –æ–∫–Ω–æ
                    state.openWindows[appId].classList.remove('minimized');
                    bringWindowToFront(appId);
                } else {
                    // –°–≤–µ—Ä–Ω—É—Ç—å –æ–∫–Ω–æ
                    state.openWindows[appId].classList.add('minimized');
                    updateActiveIndicator(appId, false);
                }
            } else {
                // –û—Ç–∫—Ä—ã—Ç—å –æ–∫–Ω–æ
                openApp(appId);
            }
        }

        // –°–æ–∑–¥–∞—Ç—å –æ–∫–Ω–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        function createAppWindow(appId) {
            const app = apps[appId];
            const windowsContainer = document.getElementById('windows-container');
            
            const windowElement = document.createElement('div');
            windowElement.className = 'window';
            windowElement.dataset.app = appId;
            
            // –î–ª—è –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π —Å–æ–∑–¥–∞–µ–º —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç
            if (app.builtin) {
                windowElement.innerHTML = `
                    <div class="window-header">
                        <div class="window-title">
                            <span>${app.icon}</span>
                            <span>${app.name}</span>
                        </div>
                        <div class="window-controls">
                            <div class="window-control minimize" onclick="minimizeApp('${appId}')"></div>
                            <div class="window-control maximize" onclick="maximizeApp('${appId}')"></div>
                            <div class="window-control close" onclick="closeApp('${appId}')"></div>
                        </div>
                    </div>
                    <div class="window-content">
                        ${getBuiltinAppContent(appId)}
                    </div>
                `;
            } else {
                windowElement.innerHTML = `
                    <div class="window-header">
                        <div class="window-title">
                            <span>${app.icon}</span>
                            <span>${app.name}</span>
                        </div>
                        <div class="window-controls">
                            <div class="window-control minimize" onclick="minimizeApp('${appId}')"></div>
                            <div class="window-control maximize" onclick="maximizeApp('${appId}')"></div>
                            <div class="window-control close" onclick="closeApp('${appId}')"></div>
                        </div>
                    </div>
                    <div class="window-content">
                        <iframe src="${app.url}" frameborder="0"></iframe>
                    </div>
                `;
            }
            
            windowsContainer.appendChild(windowElement);
            state.openWindows[appId] = windowElement;
            
            // –î–µ–ª–∞–µ–º –æ–∫–Ω–æ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–µ–º—ã–º
            makeWindowDraggable(windowElement);
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
            if (appId === 'ai') {
                initializeAIChat();
            } else if (appId === 'settings') {
                initializeSettings();
            }
            
            return windowElement;
        }

        // –ü–æ–ª—É—á–∏—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç –¥–ª—è –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        function getBuiltinAppContent(appId) {
            switch(appId) {
                case 'ai':
                    return `
                        <div style="padding: 20px; height: 100%; display: flex; flex-direction: column;">
                            <div id="ai-chat" style="flex: 1; overflow-y: auto; margin-bottom: 20px; padding: 10px; background: rgba(0,0,0,0.2); border-radius: 10px;">
                                <div class="ai-message">
                                    <strong>Neuron AI:</strong> –ü—Ä–∏–≤–µ—Ç! –Ø –≤–∞—à AI-–ø–æ–º–æ—â–Ω–∏–∫. –ß–µ–º –º–æ–≥—É –ø–æ–º–æ—á—å?
                                </div>
                            </div>
                            <div style="display: flex; gap: 10px;">
                                <input type="text" id="ai-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É –∏–ª–∏ –≤–æ–ø—Ä–æ—Å..." style="flex: 1; padding: 10px; border: 1px solid rgba(255,255,255,0.2); border-radius: 10px; background: rgba(255,255,255,0.1); color: white;">
                                <button id="ai-send" style="padding: 10px 20px; background: #4ecdc4; border: none; border-radius: 10px; color: white; cursor: pointer;">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
                            </div>
                        </div>
                    `;
                case 'settings':
                    return `
                        <div style="padding: 20px; height: 100%; overflow-y: auto;">
                            <h3 style="margin-bottom: 20px;">–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∏—Å—Ç–µ–º—ã</h3>
                            
                            <div class="setting-section" style="margin-bottom: 30px;">
                                <h4 style="margin-bottom: 15px;">–û–±–æ–∏</h4>
                                <div style="display: flex; gap: 15px; flex-wrap: wrap; margin-bottom: 15px;">
                                    <div class="wallpaper-preview active" data-wallpaper="default" style="width: 120px; height: 80px; background: linear-gradient(135deg, #0c0c0c 0%, #1a1a2e 50%, #16213e 100%); border-radius: 10px; cursor: pointer; border: 2px solid #4ecdc4;" onclick="selectWallpaper(this)"></div>
                                    <div class="wallpaper-preview" data-wallpaper="space" style="width: 120px; height: 80px; background: linear-gradient(135deg, #000428 0%, #004e92 100%); border-radius: 10px; cursor: pointer;" onclick="selectWallpaper(this)"></div>
                                    <div class="wallpaper-preview" data-wallpaper="nature" style="width: 120px; height: 80px; background: linear-gradient(135deg, #134E5E 0%, #71B280 100%); border-radius: 10px; cursor: pointer;" onclick="selectWallpaper(this)"></div>
                                    <div class="wallpaper-preview" data-wallpaper="city" style="width: 120px; height: 80px; background: linear-gradient(135deg, #2C3E50 0%, #4CA1AF 100%); border-radius: 10px; cursor: pointer;" onclick="selectWallpaper(this)"></div>
                                </div>
                                <input type="file" id="wallpaper-upload" accept="image/*" style="margin-bottom: 15px;">
                                <button onclick="applyWallpaper()" style="padding: 10px 20px; background: #4ecdc4; border: none; border-radius: 10px; color: white; cursor: pointer;">–ü—Ä–∏–º–µ–Ω–∏—Ç—å –æ–±–æ–∏</button>
                            </div>
                            
                            <div class="setting-section" style="margin-bottom: 30px;">
                                <h4 style="margin-bottom: 15px;">–¢–µ–º–∞</h4>
                                <div style="display: flex; gap: 15px;">
                                    <button onclick="setTheme('dark')" style="padding: 10px 20px; background: #333; border: none; border-radius: 10px; color: white; cursor: pointer;">–¢—ë–º–Ω–∞—è</button>
                                    <button onclick="setTheme('light')" style="padding: 10px 20px; background: #f0f0f0; border: none; border-radius: 10px; color: #333; cursor: pointer;">–°–≤–µ—Ç–ª–∞—è</button>
                                </div>
                            </div>
                        </div>
                    `;
                default:
                    return `<div style="padding: 20px; text-align: center;">–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ</div>`;
            }
        }

        // –°–¥–µ–ª–∞—Ç—å –æ–∫–Ω–æ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–µ–º—ã–º
        function makeWindowDraggable(windowElement) {
            const header = windowElement.querySelector('.window-header');
            let isDragging = false;
            let offsetX, offsetY;
            
            header.addEventListener('mousedown', (e) => {
                isDragging = true;
                offsetX = e.clientX - windowElement.offsetLeft;
                offsetY = e.clientY - windowElement.offsetTop;
                bringWindowToFront(windowElement.dataset.app);
                e.preventDefault();
            });
            
            document.addEventListener('mousemove', (e) => {
                if (!isDragging) return;
                
                const x = e.clientX - offsetX;
                const y = e.clientY - offsetY;
                
                // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö —ç–∫—Ä–∞–Ω–∞
                const maxX = window.innerWidth - windowElement.offsetWidth;
                const maxY = window.innerHeight - windowElement.offsetHeight - 70;
                
                windowElement.style.left = Math.max(0, Math.min(x, maxX)) + 'px';
                windowElement.style.top = Math.max(0, Math.min(y, maxY)) + 'px';
            });
            
            document.addEventListener('mouseup', () => {
                isDragging = false;
            });
        }

        // –ó–∞–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
        function closeApp(appId) {
            if (state.openWindows[appId]) {
                state.openWindows[appId].remove();
                delete state.openWindows[appId];
                updateActiveIndicator(appId, false);
            }
        }

        // –°–≤–µ—Ä–Ω—É—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
        function minimizeApp(appId) {
            if (state.openWindows[appId]) {
                state.openWindows[appId].classList.add('minimized');
                updateActiveIndicator(appId, false);
            }
        }

        // –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
        function maximizeApp(appId) {
            if (state.openWindows[appId]) {
                state.openWindows[appId].classList.toggle('maximized');
            }
        }

        // –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –æ–∫–Ω–æ –Ω–∞ –ø–µ—Ä–µ–¥–Ω–∏–π –ø–ª–∞–Ω
        function bringWindowToFront(appId) {
            if (!state.openWindows[appId]) return;
            
            Object.values(state.openWindows).forEach(window => {
                window.style.zIndex = 10;
            });
            
            state.openWindows[appId].style.zIndex = 20;
            updateActiveApp(appId);
        }

        // –û–±–Ω–æ–≤–∏—Ç—å –∞–∫—Ç–∏–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
        function updateActiveApp(appId) {
            state.activeApp = appId;
            updateActiveIndicator(appId, true);
        }

        // –û–±–Ω–æ–≤–∏—Ç—å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –≤ Dock
        function updateActiveIndicator(appId, isActive) {
            const dockItem = document.querySelector(`.dock-item[data-app="${appId}"]`);
            if (dockItem) {
                const indicator = dockItem.querySelector('.active-indicator');
                if (indicator) {
                    indicator.style.display = isActive ? 'block' : 'none';
                }
            }
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–µ –º–µ–Ω—é
        function showContextMenu(e, appId) {
            const contextMenu = document.getElementById('context-menu');
            contextMenu.style.display = 'block';
            contextMenu.style.left = e.pageX + 'px';
            contextMenu.style.top = e.pageY + 'px';
            contextMenu.dataset.targetApp = appId;
        }

        // –°–∫—Ä—ã—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–µ –º–µ–Ω—é
        function hideContextMenu() {
            document.getElementById('context-menu').style.display = 'none';
        }

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–µ–π—Å—Ç–≤–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–≥–æ –º–µ–Ω—é
        function handleContextMenuAction(action) {
            const contextMenu = document.getElementById('context-menu');
            const appId = contextMenu.dataset.targetApp;
            const app = apps[appId];
            
            switch(action) {
                case 'pin':
                    if (!state.dockApps.includes(appId)) {
                        state.dockApps.push(appId);
                        addAppToDock(appId);
                        saveUserData();
                    }
                    break;
                    
                case 'open-tab':
                    if (app.url) {
                        window.open(app.url, '_blank');
                    }
                    break;
                    
                case 'ask-ai':
                    openApp('ai');
                    setTimeout(() => {
                        const aiInput = document.getElementById('ai-input');
                        if (aiInput) {
                            aiInput.value = `–†–∞—Å—Å–∫–∞–∂–∏ –æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ ${app.name}`;
                            document.getElementById('ai-send').click();
                        }
                    }, 500);
                    break;
            }
            
            hideContextMenu();
        }

        // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –≤ –º–µ–Ω—é "–ü—É—Å–∫"
        function filterApps() {
            const searchTerm = document.getElementById('app-search').value.toLowerCase();
            const appItems = document.querySelectorAll('.app-item');
            
            appItems.forEach(item => {
                const appName = item.querySelector('span').textContent.toLowerCase();
                if (appName.includes(searchTerm)) {
                    item.style.display = 'flex';
                } else {
                    item.style.display = 'none';
                }
            });
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —á–∞—Ç–∞ —Å –ò–ò
        function initializeAIChat() {
            const sendBtn = document.getElementById('ai-send');
            const input = document.getElementById('ai-input');
            
            if (!sendBtn || !input) return;
            
            const sendMessage = () => {
                const message = input.value.trim();
                if (!message) return;
                
                addAIMessage('user', message);
                input.value = '';
                
                setTimeout(() => {
                    const response = generateAIResponse(message);
                    addAIMessage('ai', response);
                }, 1000);
            };
            
            sendBtn.addEventListener('click', sendMessage);
            input.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') sendMessage();
            });
        }

        // –î–æ–±–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ —á–∞—Ç –ò–ò
        function addAIMessage(sender, text) {
            const chat = document.getElementById('ai-chat');
            if (!chat) return;
            
            const messageDiv = document.createElement('div');
            messageDiv.className = 'ai-message';
            messageDiv.innerHTML = `<strong>${sender === 'user' ? '–í—ã' : 'Neuron AI'}:</strong> ${text}`;
            messageDiv.style.marginBottom = '10px';
            messageDiv.style.padding = '8px';
            messageDiv.style.background = sender === 'user' ? 'rgba(78, 205, 196, 0.2)' : 'rgba(255, 255, 255, 0.1)';
            messageDiv.style.borderRadius = '8px';
            
            chat.appendChild(messageDiv);
            chat.scrollTop = chat.scrollHeight;
        }

        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–∞ –ò–ò
        function generateAIResponse(message) {
            const lowerMessage = message.toLowerCase();
            
            if (lowerMessage.includes('–ø—Ä–∏–≤–µ—Ç') || lowerMessage.includes('hello')) {
                return '–ü—Ä–∏–≤–µ—Ç! –Ø Neuron AI, –≤–∞—à –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π –ø–æ–º–æ—â–Ω–∏–∫. –ß–µ–º –º–æ–≥—É –ø–æ–º–æ—á—å?';
            }
            
            if (lowerMessage.includes('–∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä') || lowerMessage.includes('converter')) {
                return 'Neuron Converter - —ç—Ç–æ –º–æ—â–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ –≤–∞–ª—é—Ç, –µ–¥–∏–Ω–∏—Ü –∏–∑–º–µ—Ä–µ–Ω–∏—è –∏ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä. –û–Ω –ø–æ–∑–≤–æ–ª—è–µ—Ç –±—ã—Å—Ç—Ä–æ –ø–µ—Ä–µ–≤–æ–¥–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –º–µ–∂–¥—É —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏ –∏–∑–º–µ—Ä–µ–Ω–∏–π.';
            }
            
            if (lowerMessage.includes('–∑–∞–º–µ—Ç–∫') || lowerMessage.includes('notes')) {
                return 'Neuron Notes - —ç—Ç–æ —É–º–Ω—ã–µ –∑–∞–º–µ—Ç–∫–∏ —Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–µ–π –º–µ–∂–¥—É —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏. –í—ã –º–æ–∂–µ—Ç–µ —Å–æ–∑–¥–∞–≤–∞—Ç—å, —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∏ –æ—Ä–≥–∞–Ω–∏–∑–æ–≤—ã–≤–∞—Ç—å —Å–≤–æ–∏ –∑–∞–º–µ—Ç–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –¥–æ—Å—Ç—É–ø–Ω—ã –Ω–∞ –≤—Å–µ—Ö –≤–∞—à–∏—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö.';
            }
            
            if (lowerMessage.includes('–±—é–¥–∂–µ—Ç') || lowerMessage.includes('budget')) {
                return 'Neuron Budget –ø–æ–º–æ–≥–∞–µ—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –≤–∞—à–∏ –¥–æ—Ö–æ–¥—ã –∏ —Ä–∞—Å—Ö–æ–¥—ã. –í—ã –º–æ–∂–µ—Ç–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ —Ü–µ–ª–∏, –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ç—Ä–∞—Ç—ã –∏ –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å–≤–æ–∏ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –ø—Ä–∏–≤—ã—á–∫–∏.';
            }
            
            if (lowerMessage.includes('–∏–≥—Ä') || lowerMessage.includes('game')) {
                return 'Game Hub - —ç—Ç–æ –∫–æ–ª–ª–µ–∫—Ü–∏—è —É–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω—ã—Ö –∏–≥—Ä –¥–ª—è —Ä–∞–∑–≤–ª–µ—á–µ–Ω–∏—è –≤ –ø–µ—Ä–µ—Ä—ã–≤–∞—Ö –º–µ–∂–¥—É —Ä–∞–±–æ—Ç–æ–π. –û—Ç –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏—Ö –≥–æ–ª–æ–≤–æ–ª–æ–º–æ–∫ –¥–æ –∞—Ä–∫–∞–¥–Ω—ã—Ö –∏–≥—Ä - –Ω–∞–π–¥–µ—Ç—Å—è —Ä–∞–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ.';
            }
            
            if (lowerMessage.includes('–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç') || lowerMessage.includes('tools')) {
                return 'Neuron Tools - —ç—Ç–æ –Ω–∞–±–æ—Ä –ø–æ–ª–µ–∑–Ω—ã—Ö —É—Ç–∏–ª–∏—Ç –¥–ª—è –ø–æ–≤—Å–µ–¥–Ω–µ–≤–Ω—ã—Ö –∑–∞–¥–∞—á. –û—Ç –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞ –∏ —Ç–∞–π–º–µ—Ä–∞ –¥–æ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞ –ø–∞—Ä–æ–ª–µ–π –∏ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –º–æ–Ω–∏—Ç–æ—Ä–æ–≤.';
            }
            
            if (lowerMessage.includes('/help')) {
                return '–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:\n/open notes - –æ—Ç–∫—Ä—ã—Ç—å –∑–∞–º–µ—Ç–∫–∏\n/convert 100 USD RUB - –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤–∞–ª—é—Ç—É\n/theme dark - —Å–º–µ–Ω–∏—Ç—å —Ç–µ–º—É\n/help - –ø–æ–∫–∞–∑–∞—Ç—å —Å–ø—Ä–∞–≤–∫—É\n/about - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–∏—Å—Ç–µ–º–µ';
            }
            
            if (lowerMessage.includes('/about')) {
                return 'Neuron OS - –≤–µ–±-–æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Å —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º. –í–µ—Ä—Å–∏—è 1.0. –†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–∞ Neuron Ecosystem.';
            }
            
            return '–Ø –ø–æ–∫–∞ –Ω–µ –Ω–∞—É—á–∏–ª—Å—è –æ—Ç–≤–µ—á–∞—Ç—å –Ω–∞ —ç—Ç–æ—Ç –≤–æ–ø—Ä–æ—Å. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–ø—Ä–æ—Å–∏—Ç—å –æ —Ñ—É–Ω–∫—Ü–∏—è—Ö Neuron OS –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É /help –¥–ª—è —Å–ø–∏—Å–∫–∞ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∫–æ–º–∞–Ω–¥.';
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫
        function initializeSettings() {
            // –ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –æ–±–æ–µ–≤
            document.getElementById('wallpaper-upload').addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(event) {
                        const wallpaper = document.querySelector('.wallpaper');
                        wallpaper.style.backgroundImage = `url(${event.target.result})`;
                        wallpaper.style.backgroundSize = 'cover';
                        wallpaper.style.backgroundPosition = 'center';
                        alert('–û–±–æ–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã!');
                    };
                    reader.readAsDataURL(file);
                }
            });
        }

        // –í—ã–±–æ—Ä –æ–±–æ–µ–≤
        function selectWallpaper(element) {
            document.querySelectorAll('.wallpaper-preview').forEach(p => {
                p.style.border = 'none';
            });
            element.style.border = '2px solid #4ecdc4';
            element.classList.add('active');
        }

        // –ü—Ä–∏–º–µ–Ω–∏—Ç—å –æ–±–æ–∏
        function applyWallpaper() {
            const activeWallpaper = document.querySelector('.wallpaper-preview.active');
            if (activeWallpaper) {
                const wallpaperType = activeWallpaper.dataset.wallpaper;
                const wallpaper = document.querySelector('.wallpaper');
                
                switch(wallpaperType) {
                    case 'default':
                        wallpaper.style.background = 'linear-gradient(135deg, #0c0c0c 0%, #1a1a2e 50%, #16213e 100%)';
                        break;
                    case 'space':
                        wallpaper.style.background = 'linear-gradient(135deg, #000428 0%, #004e92 100%)';
                        break;
                    case 'nature':
                        wallpaper.style.background = 'linear-gradient(135deg, #134E5E 0%, #71B280 100%)';
                        break;
                    case 'city':
                        wallpaper.style.background = 'linear-gradient(135deg, #2C3E50 0%, #4CA1AF 100%)';
                        break;
                }
                wallpaper.style.backgroundImage = 'none';
                alert('–û–±–æ–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã!');
            }
        }

        // –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–µ–º—É
        function setTheme(theme) {
            if (theme === 'dark') {
                document.body.style.filter = 'none';
                alert('–¢—ë–º–Ω–∞—è —Ç–µ–º–∞ –ø—Ä–∏–º–µ–Ω–µ–Ω–∞!');
            } else {
                alert('–°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞ –±—É–¥–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –≤ –±—É–¥—É—â–∏—Ö –≤–µ—Ä—Å–∏—è—Ö');
            }
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function loadUserData() {
            const savedData = localStorage.getItem('neuron_user_data');
            if (savedData) {
                state.userData = JSON.parse(savedData);
                applyUserPreferences();
            }
        }

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function saveUserData() {
            localStorage.setItem('neuron_user_data', JSON.stringify({
                dockApps: state.dockApps,
                lastUpdated: new Date()
            }));
        }

        // –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫
        function applyUserPreferences() {
            if (state.userData.dockApps) {
                state.dockApps = state.userData.dockApps;
                initializeDock();
            }
        }

        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
        window.openApp = openApp;
        window.handleLogin = handleLogin;
        window.handleGoogleLogin = handleGoogleLogin;
        window.handleRegister = handleRegister;
        window.handleContextMenuAction = handleContextMenuAction;
        window.filterApps = filterApps;
        window.activateDemoMode = activateDemoMode;
        window.closeApp = closeApp;
        window.minimizeApp = minimizeApp;
        window.maximizeApp = maximizeApp;
        window.selectWallpaper = selectWallpaper;
        window.applyWallpaper = applyWallpaper;
        window.setTheme = setTheme;
    </script>
</body>
</html>
